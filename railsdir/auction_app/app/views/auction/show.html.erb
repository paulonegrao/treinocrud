<h1><%= @auction.title %></h1>
<p><%= @auction.description %></p>
<p>Goal: <%= @auction.goal %></p>
<p>End Date: <%= @auction.end_date %></p>
<p><%= @auction.state_label %></p>
<%# may_publish? is a method generated by AASM that will tell you if you're able
    to publish a auction based on the rules defined in the Auction AASM %>
<%= @auction.publish_button %>

<%= link_to "Edit", edit_auction_path(@auction), class: "btn btn-info" %>
<%= link_to "Delete", @auction, class: "btn btn-danger" %>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>

<script>
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers([
      {
        "lat": <%= @auction.latitude %>,
        "lng": <%= @auction.longitude %>,
        "infowindow": "<%= @auction.title %>"
      }
    ]);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
  });
</script>

<hr>
<% @auction.bids.each do |bid| %>
  <div class="col-md-3 well">
    <%= number_to_currency(bid.amount) %>
    <p><%= bid.body %></p>
  </div>
<% end %>
<div class="clearfix"></div>
<hr>
<h2>Make a bid</h2>
<%= simple_form_for [@auction, @bid] do |f| %>
  <%= f.input :amount, as: :string %>
  <%= f.submit "bid", class: "btn btn-primary" %>
<% end %>

<hr>
<h2>Comments</h2>

<%= simple_form_for [@auction, @comment] do |f| %>
  <%= f.input :body %>
  <%= f.submit %>
<% end %>

<% @auction.comments.each do |com| %>
  <div class="well">
    <%= com.body %>
  </div>
<% end %>
